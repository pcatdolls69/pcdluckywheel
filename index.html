<!DOCTYPE html>
<html lang="zh-Hans">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PCD Lucky Wheel</title>
<style>
:root{
Â Â --brand:#6e2b74;
Â Â --shadow:0 8px 30px rgba(0,0,0,.15);
}
body{
Â Â margin:0;
Â Â height:100vh;
Â Â display:flex;
Â Â flex-direction:column;
Â Â justify-content:center;
Â Â align-items:center;
Â Â background:linear-gradient(180deg,#f8e7ff,#ffe6f2,#d9ecff);
Â Â font-family:-apple-system,BlinkMacSystemFont,"PingFang SC",sans-serif;
Â Â color:#333;
}
.card{
Â Â background:#fff;
Â Â border-radius:20px;
Â Â box-shadow:var(--shadow);
Â Â padding:20px;
Â Â width:95%;
Â Â max-width:420px;
Â Â text-align:center;
}
canvas{
Â Â width:100%;
Â Â height:auto;
Â Â border-radius:50%;
Â Â box-shadow:inset 0 0 0 12px #f3e4ff;
}
.pointer{
Â Â position:absolute;
Â Â top:50%;
Â Â left:50%;
Â Â transform:translate(-50%,-58%);
Â Â width:60px;
Â Â height:60px;
Â Â border-radius:50%;
Â Â background:radial-gradient(circle,#fff 40%,var(--brand) 45%);
Â Â z-index:10;
}
.pointer::before{
Â Â content:"";
Â Â position:absolute;
Â Â top:-8px;
Â Â left:50%;
Â Â transform:translateX(-50%);
Â Â width:0;
Â Â height:0;
Â Â border-left:12px solid transparent;
Â Â border-right:12px solid transparent;
Â Â border-bottom:18px solid var(--brand);
}
button{
Â Â margin-top:18px;
Â Â padding:12px 24px;
Â Â font-size:18px;
Â Â font-weight:600;
Â Â background:linear-gradient(135deg,#f7d1ff,#ffd1d1);
Â Â border:none;
Â Â border-radius:16px;
Â Â cursor:pointer;
Â Â color:#5a1c6d;
Â Â box-shadow:var(--shadow);
}
button:disabled{opacity:.6;cursor:not-allowed;}
#status{margin-top:10px;font-size:15px;color:#666;}
.chips{display:flex;justify-content:center;gap:10px;margin-top:12px;}
.chip{
Â Â background:#fff;
Â Â box-shadow:var(--shadow);
Â Â border-radius:14px;
Â Â padding:10px 14px;
Â Â font-size:14px;
Â Â font-weight:600;
}
.footer{
Â Â font-size:13px;
Â Â color:#777;
Â Â margin-top:16px;
Â Â line-height:1.5;
}
</style>
</head>
<body>
<div class="card">
Â Â <div style="position:relative;">
Â Â Â Â <canvas id="wheel" width="350" height="350"></canvas>
Â Â Â Â <div class="pointer"></div>
Â Â </div>
Â Â <button id="spinBtn">ğŸ¡ Start Spin</button>
Â Â <div id="status"></div>

Â Â <div class="chips">
Â Â Â Â <div id="subBtn" class="chip">âœ… Subscribe</div>
Â Â Â Â <div id="shareBtn" class="chip">ğŸ”— Share</div>
Â Â </div>

Â Â <div class="footer">
Â Â Â Â âš ï¸ æ‰€æœ‰å¥–é¡¹ä¸èƒ½é‡å ä½¿ç”¨<br>
Â Â Â Â (All rewards cannot be combined)<br>
Â Â Â Â è®¢é˜…å¹¶åˆ†äº«é¢‘é“å¯å¤šä¸€æ¬¡æœºä¼š / Subscribe & Share for +1 spin<br>
Â Â Â Â <a href="https://t.me/pcatdolls" target="_blank">ğŸ”— è®¢é˜… / Subscribe</a>
Â Â </div>
</div>

<script>
const prizes = [
Â Â "45â° or 60â° / 10 off",
Â Â "45â° or 60â° / 20 off",
Â Â "ğŸ One more spin chance",
Â Â "45â° or 60â° / 10 off",
Â Â "Sorry ğŸ˜¢",
Â Â "45â° or 60â° / 20 off",
Â Â "Sorry ğŸ˜¢",
Â Â "45â° or 60â° / 40 off",
Â Â "Sorry ğŸ˜¢"
];

const colors = [
Â Â "#ffd8e8","#e2d6ff","#d9f0ff","#fff6c2",
Â Â "#fbd1ff","#d6eaff","#ffead1","#f4dfff","#ffddee"
];

const wheel = document.getElementById("wheel");
const ctx = wheel.getContext("2d");
const n = prizes.length;
const angleStep = 2 * Math.PI / n;
let rotation = 0;
let spinning = false;

function drawWheel(){
Â Â const r = wheel.width / 2;
Â Â ctx.clearRect(0,0,wheel.width,wheel.height);
Â Â ctx.save();
Â Â ctx.translate(r,r);
Â Â ctx.rotate(-Math.PI/2);
Â Â for(let i=0;i<n;i++){
Â Â Â Â ctx.beginPath();
Â Â Â Â ctx.moveTo(0,0);
Â Â Â Â ctx.fillStyle = colors[i%colors.length];
Â Â Â Â ctx.arc(0,0,r,i*angleStep,(i+1)*angleStep);
Â Â Â Â ctx.fill();
Â Â Â Â ctx.save();
Â Â Â Â ctx.rotate(i*angleStep+angleStep/2);
Â Â Â Â ctx.textAlign="center";
Â Â Â Â ctx.fillStyle="#333";
Â Â Â Â ctx.font="bold 14px Arial";
Â Â Â Â ctx.translate(r*0.7,0);
Â Â Â Â ctx.rotate(Math.PI/2);
Â Â Â Â wrapText(ctx,prizes[i],0,0,r*0.4,16);
Â Â Â Â ctx.restore();
Â Â }
Â Â ctx.restore();
}

function wrapText(ctx,text,x,y,maxWidth,lineHeight){
Â Â const words=text.split(" ");
Â Â let line="",yy=y;
Â Â for(let w of words){
Â Â Â Â const test=line+w+" ";
Â Â Â Â if(ctx.measureText(test).width>maxWidth && line){
Â Â Â Â Â Â ctx.fillText(line,x,yy);
Â Â Â Â Â Â line=w+" ";
Â Â Â Â Â Â yy+=lineHeight;
Â Â Â Â } else line=test;
Â Â }
Â Â ctx.fillText(line,x,yy);
}

function periodKey(){
Â Â const d=new Date();
Â Â return Math.floor(d.getTime()/(3*86400000)); // 3 days
}

const KEY="pcd_wheel_v3";
function loadState(){
Â Â const s=JSON.parse(localStorage.getItem(KEY)||"{}");
Â Â if(s.period!==periodKey()) return {period:periodKey(),used:0,sub:false,share:false};
Â Â return s;
}
let state=loadState();
function save(){localStorage.setItem(KEY,JSON.stringify(state));}
function allowance(){return 1+(state.sub&&state.share?1:0);}
function remaining(){return Math.max(0,allowance()-state.used);}
function updateStatus(){
Â Â document.getElementById("status").innerHTML=`å‰©ä½™æ¬¡æ•° / Spins left: ${remaining()}`;
}

function spin(){
Â Â if(spinning || remaining()<=0) return alert("No spins left!");
Â Â spinning=true;
Â Â const index=Math.floor(Math.random()*n);
Â Â const target=-Math.PI/2 - (index*angleStep+angleStep/2);
Â Â const extra=2*Math.PI*5;
Â Â const finalRot=rotation+extra+target;
Â Â const start=performance.now(),duration=4200;
Â Â const step=t=>{
Â Â Â Â const p=Math.min(1,(t-start)/duration);
Â Â Â Â const ease=1-Math.pow(1-p,3);
Â Â Â Â rotation+= (finalRot-rotation)*ease;
Â Â Â Â drawWheel();
Â Â Â Â if(p<1) requestAnimationFrame(step);
Â Â Â Â else{
Â Â Â Â Â Â rotation%=2*Math.PI;
Â Â Â Â Â Â const result=prizes[index];
Â Â Â Â Â Â finish(result);
Â Â Â Â }
Â Â };
Â Â requestAnimationFrame(step);
}

function finish(result){
Â Â if(result.includes("One more spin")){
Â Â Â Â alert("ğŸ One more spin added!");
Â Â } else {
Â Â Â Â state.used++;
Â Â Â Â alert("ğŸ‰ Result: "+result);
Â Â }
Â Â save();updateStatus();
Â Â if(window.Telegram?.WebApp){
Â Â Â Â window.Telegram.WebApp.sendData(JSON.stringify({
Â Â Â Â Â Â result,used:state.used,remaining:remaining(),
Â Â Â Â Â Â subscribed:state.sub,shared:state.share,
Â Â Â Â Â Â period:periodKey(),lang:navigator.language
Â Â Â Â }));
Â Â }
Â Â spinning=false;
Â Â document.getElementById("spinBtn").disabled = remaining()<=0;
}

document.getElementById("spinBtn").onclick=spin;
document.getElementById("subBtn").onclick=()=>{
Â Â window.open("https://t.me/pcatdolls","_blank");
Â Â state.sub=true;save();updateStatus();
};
document.getElementById("shareBtn").onclick=()=>{
Â Â window.open(`https://t.me/share/url?url=${encodeURIComponent(location.href)}&text=ğŸ¡PCD+Lucky+Wheel`,"_blank");
Â Â state.share=true;save();updateStatus();
};

drawWheel();updateStatus();
</script>
</body>
</html>
