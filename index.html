<!DOCTYPE html>
<html lang="zh-Hans">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>PCD Lucky Wheel â€” CN/EN</title>
<style>
:root {
Â Â --brand: #6e2b74;
Â Â --ring: #eadcf3;
Â Â --card: #ffffff;
Â Â --bg1: #fbf1ff;
Â Â --grad1: #f7d1ff;
Â Â --grad2: #ffd1d1;
Â Â --shadow: 0 6px 16px rgba(0,0,0,0.1);
Â Â --text: #2b2b2b;
Â Â --muted: #7d7d7d;
}
*{box-sizing:border-box;}
body {
Â Â display:flex;flex-direction:column;align-items:center;justify-content:center;
Â Â min-height:100vh;margin:0;background:radial-gradient(800px at 50% -150px,var(--bg1),#fff);
Â Â font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'PingFang SC',sans-serif;
Â Â color:var(--text);
}
.card {
Â Â background:var(--card);
Â Â border-radius:26px;
Â Â box-shadow:var(--shadow);
Â Â padding:24px 18px 28px;
Â Â width:min(600px,92vw);
}
.stage {
Â Â position:relative;background:#fff;border-radius:20px;padding:18px;
Â Â box-shadow:inset 0 0 0 2px #f2e9f7;
}
.wheelWrap {
Â Â width:100%;aspect-ratio:1/1;position:relative;
}
canvas {
Â Â width:100%;height:100%;border-radius:50%;
Â Â box-shadow:inset 0 0 0 14px var(--ring),inset 0 0 0 3px #fff;
}
.center-pointer {
Â Â position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
Â Â width:22%;aspect-ratio:1/1;border-radius:50%;
Â Â background:radial-gradient(circle,#fff 35%,#fff 36%,var(--brand) 36%,var(--brand) 100%);
}
.center-pointer::before {
Â Â content:"";position:absolute;top:8%;left:50%;transform:translate(-50%,-50%);
Â Â border-left:10px solid transparent;border-right:10px solid transparent;
Â Â border-bottom:16px solid var(--brand);
}
.actions {display:flex;justify-content:center;margin:20px 0 8px;}
.btn {
Â Â background:linear-gradient(180deg,#f7d1ff,#ffd1d1);
Â Â color:#632d79;border:0;border-radius:18px;
Â Â padding:12px 28px;font-size:20px;font-weight:700;cursor:pointer;
Â Â box-shadow:var(--shadow);
}
.btn:disabled {opacity:0.6;cursor:not-allowed;}
.chipRow {display:flex;justify-content:center;gap:12px;margin:10px 0;}
.chip {
Â Â display:flex;align-items:center;gap:8px;padding:10px 16px;
Â Â background:#fff;border-radius:16px;font-weight:600;
Â Â box-shadow:var(--shadow);
}
.chip .dot {font-size:20px;}
.muted {color:var(--muted);font-size:14px;text-align:center;line-height:1.6;}
.status {margin-top:8px;}
</style>
</head>
<body>
<div class="card">
Â Â <div class="stage">
Â Â Â Â <div class="wheelWrap">
Â Â Â Â Â Â <canvas id="wheel"></canvas>
Â Â Â Â Â Â <div class="center-pointer"></div>
Â Â Â Â </div>
Â Â </div>

Â Â <div class="actions">
Â Â Â Â <button id="startBtn" class="btn">å¼€å§‹ / Start</button>
Â Â </div>

Â Â <div class="chipRow">
Â Â Â Â <button id="subBtn" class="chip"><span class="dot">âœ…</span>è®¢é˜… / Subscribe</button>
Â Â Â Â <button id="shareBtn" class="chip"><span class="dot">ğŸ”—</span>åˆ†äº« / Share</button>
Â Â </div>

Â Â <div class="muted">
Â Â Â Â ğŸŒŸ æ¯ 3 å¤© 1 æ¬¡ï¼›å®Œæˆè®¢é˜… + åˆ†äº« å† +1ï¼›æŠ½åˆ° ğŸ one more chance å† +1<br>
Â Â Â Â (Every 3 days 1 spin; +1 after subscribing + sharing; +1 on ğŸ one more chance)
Â Â </div>
Â Â <div id="status" class="muted status"></div>
</div>

<script>
(() => {
Â Â const prizes = [
Â Â Â Â "1 ğŸ˜¢ sorry",
Â Â Â Â "45â° or 60â° / 10 off",
Â Â Â Â "3 ğŸ˜¢ sorry",
Â Â Â Â "45â° or 60â° / 20 off",
Â Â Â Â "ğŸ one more chance",
Â Â Â Â "8 ğŸ˜¢ sorry",
Â Â Â Â "45â° or 60â° / 40 off",
Â Â Â Â "5 ğŸ˜¢ sorry",
Â Â Â Â "45â° or 60â° / 10 off"
Â Â ];
Â Â const segColors = ["#dbe7ff","#ffd7d7","#d6f9ff","#ffe5b8","#fff0c2","#e3d8ff","#ffd7d7","#d6f9ff","#ffd1e1"];
Â Â const n = prizes.length;
Â Â const wheel = document.getElementById("wheel");
Â Â const ctx = wheel.getContext("2d");
Â Â const DPR = window.devicePixelRatio || 1;
Â Â const size = 600;
Â Â wheel.width = wheel.height = size * DPR;
Â Â ctx.scale(DPR, DPR);
Â Â const R = size/2 * 0.8;
Â Â const CX = size/2, CY = size/2;
Â Â const segmentAngle = 2*Math.PI / n;
Â Â let currentRotation = 0;

Â Â function drawWheel(){
Â Â Â Â ctx.clearRect(0,0,size,size);
Â Â Â Â ctx.save();
Â Â Â Â ctx.translate(CX,CY);
Â Â Â Â ctx.rotate(-Math.PI/2);
Â Â Â Â for(let i=0;i<n;i++){
Â Â Â Â Â Â ctx.beginPath();
Â Â Â Â Â Â ctx.moveTo(0,0);
Â Â Â Â Â Â ctx.fillStyle = segColors[i%segColors.length];
Â Â Â Â Â Â ctx.arc(0,0,R,i*segmentAngle,(i+1)*segmentAngle);
Â Â Â Â Â Â ctx.closePath(); ctx.fill();

Â Â Â Â Â Â ctx.save();
Â Â Â Â Â Â ctx.rotate(i*segmentAngle + segmentAngle/2);
Â Â Â Â Â Â ctx.textAlign="center";
Â Â Â Â Â Â ctx.fillStyle="#2b2b2b";
Â Â Â Â Â Â ctx.font="18px Arial";
Â Â Â Â Â Â ctx.translate(R*0.7,0);
Â Â Â Â Â Â ctx.rotate(Math.PI/2);
Â Â Â Â Â Â wrapText(ctx,prizes[i],0,0,R*0.35,22);
Â Â Â Â Â Â ctx.restore();
Â Â Â Â }
Â Â Â Â ctx.restore();
Â Â }

Â Â function wrapText(ctx,text,x,y,maxWidth,lineHeight){
Â Â Â Â const words=text.split(' ');let line='',yy=y;
Â Â Â Â for(let w of words){
Â Â Â Â Â Â const test=line+w+' ';
Â Â Â Â Â Â if(ctx.measureText(test).width>maxWidth && line){
Â Â Â Â Â Â Â Â ctx.fillText(line,x,yy);line=w+' ';yy+=lineHeight;
Â Â Â Â Â Â }else line=test;
Â Â Â Â }
Â Â Â Â ctx.fillText(line,x,yy);
Â Â }

Â Â // ----- Logic -----
Â Â const TG = window.Telegram?.WebApp;
Â Â if(TG){TG.expand();TG.ready();}
Â Â const KEY="pcd_luckywheel_v2";
Â Â const PERIOD_DAYS=3;
Â Â function periodKey(){
Â Â Â Â const d=new Date();
Â Â Â Â return Math.floor(d.getTime()/(PERIOD_DAYS*86400000));
Â Â }
Â Â function loadState(){
Â Â Â Â const s=JSON.parse(localStorage.getItem(KEY)||"{}");
Â Â Â Â if(s.period!==periodKey()) return {period:periodKey(),used:0,subscribed:false,shared:false};
Â Â Â Â return s;
Â Â }
Â Â let state=loadState();
Â Â function save(){localStorage.setItem(KEY,JSON.stringify(state));}
Â Â function allowance(){return 1+(state.subscribed&&state.shared?1:0);}
Â Â function remaining(){return Math.max(0,allowance()-state.used);}
Â Â function updateStatus(){
Â Â Â Â const sub=state.subscribed?"âœ…":"âŒ",shr=state.shared?"âœ…":"âŒ";
Â Â Â Â status.innerHTML=`å‰©é¤˜æ¬¡æ•¸ï¼š${remaining()}ï¼ˆé€±æœŸï¼šæ¯ ${PERIOD_DAYS} å¤©ï¼‰<br>
Â Â Â Â Allowance: ${allowance()} (used ${state.used}) Â· subscribe/share: ${sub}/${shr}`;
Â Â }

Â Â function spin(){
Â Â Â Â if(remaining()<=0){alert("æ¬¡æ•¸å·²ç”¨å®Œ / No spins left");return;}
Â Â Â Â startBtn.disabled=true;
Â Â Â Â const targetIndex=Math.floor(Math.random()*n);
Â Â Â Â const targetAngle=-Math.PI/2 - (targetIndex*segmentAngle+segmentAngle/2);
Â Â Â Â const extra=2*Math.PI*6;
Â Â Â Â const finalRot=currentRotation+extra+targetAngle;
Â Â Â Â const start=performance.now(),duration=4200;
Â Â Â Â function animate(t){
Â Â Â Â Â Â const p=Math.min(1,(t-start)/duration);
Â Â Â Â Â Â const ease=1-Math.pow(1-p,3);
Â Â Â Â Â Â currentRotation=currentRotation+(finalRot-currentRotation)*ease;
Â Â Â Â Â Â drawWheel();
Â Â Â Â Â Â if(p<1) requestAnimationFrame(animate);
Â Â Â Â Â Â else{
Â Â Â Â Â Â Â Â currentRotation%=2*Math.PI;
Â Â Â Â Â Â Â Â drawWheel();
Â Â Â Â Â Â Â Â const idx=(n - Math.floor((currentRotation/(2*Math.PI))*n))%n;
Â Â Â Â Â Â Â Â finish(idx);
Â Â Â Â Â Â }
Â Â Â Â }
Â Â Â Â requestAnimationFrame(animate);
Â Â }

Â Â function finish(idx){
Â Â Â Â const result=prizes[idx];
Â Â Â Â if(result.includes("one more chance")){
Â Â Â Â Â Â alert("ğŸ å†ä¾†ä¸€æ¬¡! +1 æ©Ÿæœƒ / One more chance!");
Â Â Â Â Â Â state.used=Math.max(0,state.used-1);
Â Â Â Â }else{
Â Â Â Â Â Â alert("ğŸ‰ æ­å–œä¸­ç / Congratulations!\n"+result);
Â Â Â Â Â Â state.used++;
Â Â Â Â }
Â Â Â Â save();updateStatus();
Â Â Â Â if(TG){
Â Â Â Â Â Â TG.sendData(JSON.stringify({
Â Â Â Â Â Â Â Â event:"spin_result",result,index:idx,
Â Â Â Â Â Â Â Â used:state.used,baseAllowance:1,bonus:allowance()-1,
Â Â Â Â Â Â Â Â remaining:remaining(),
Â Â Â Â Â Â Â Â subscribed:state.subscribed,shared:state.shared,
Â Â Â Â Â Â Â Â periodDays:PERIOD_DAYS,periodKey:periodKey(),
Â Â Â Â Â Â Â Â lang:navigator.language,ts:Date.now(),version:"v2.1"
Â Â Â Â Â Â }));
Â Â Â Â }
Â Â Â Â startBtn.disabled=remaining()<=0;
Â Â }

Â Â const startBtn=document.getElementById("startBtn");
Â Â const subBtn=document.getElementById("subBtn");
Â Â const shareBtn=document.getElementById("shareBtn");
Â Â startBtn.onclick=spin;
Â Â subBtn.onclick=()=>{window.open("https://t.me/pcatdolls","_blank");state.subscribed=true;save();updateStatus();};
Â Â shareBtn.onclick=()=>{window.open(`https://t.me/share/url?url=${encodeURIComponent(location.href)}&text=PCD+Lucky+Wheel`,"_blank");state.shared=true;save();updateStatus();};

Â Â drawWheel();updateStatus();
})();
</script>
</body>
</html>
