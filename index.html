<!DOCTYPE html>
<html lang="zh-Hant">
<html lang="zh-Hans">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>å¹¸é‹è½‰ç›¤</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<title>å¹¸è¿è½¬ç›˜ / Lucky Wheel</title>

<!-- Google Fontsï¼ˆè‹±ï¼šQuicksandï¼›ä¸­ï¼šNoto Sans SCï¼‰ -->
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">

<style>
Â Â body {
Â Â Â Â margin: 0;
Â Â Â Â font-family: Arial, sans-serif;
Â Â Â Â background: #fff0f5;
Â Â Â Â display: flex;
Â Â Â Â flex-direction: column;
Â Â Â Â align-items: center;
Â Â Â Â justify-content: start;
Â Â Â Â height: 100vh;
Â Â Â Â color: #333;
Â Â }
Â Â h2 {
Â Â Â Â margin-top: 10px;
Â Â }
Â Â #wheel-container {
Â Â Â Â position: relative;
Â Â Â Â width: 90vw;
Â Â Â Â max-width: 400px;
Â Â Â Â height: 90vw;
Â Â Â Â max-height: 400px;
Â Â Â Â margin-top: 20px;
Â Â }
Â Â canvas {
Â Â Â Â width: 100%;
Â Â Â Â height: 100%;
Â Â /* é¡µé¢ç™½åº• + å­—ä½“ */
Â Â body{
Â Â Â Â margin:0; background:#fff; color:#333;
Â Â Â Â font-family:'Quicksand','Noto Sans SC',-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",Arial,sans-serif;
Â Â Â Â display:flex; flex-direction:column; align-items:center; justify-content:center;
Â Â Â Â min-height:100vh; -webkit-tap-highlight-color:transparent; user-select:none;
Â Â }
Â Â #pointer {
Â Â Â Â position: absolute;
Â Â Â Â top: -10px;
Â Â Â Â left: 50%;
Â Â Â Â transform: translateX(-50%);
Â Â Â Â width: 0; 
Â Â Â Â height: 0; 
Â Â Â Â border-left: 15px solid transparent;
Â Â Â Â border-right: 15px solid transparent;
Â Â Â Â border-bottom: 20px solid #4B0082; /* æ·±ç´«è‰²æŒ‡é‡ */
Â Â Â Â z-index: 10;
Â Â }
Â Â #spinBtn {
Â Â Â Â margin-top: 20px;
Â Â Â Â padding: 12px 24px;
Â Â Â Â background-color: #ff69b4;
Â Â Â Â border: none;
Â Â Â Â border-radius: 8px;
Â Â Â Â color: #fff;
Â Â Â Â font-size: 16px;
Â Â Â Â cursor: pointer;
Â Â h2{margin:10px 0 12px; text-align:center; font-weight:700}
Â Â .wrap{position:relative; display:flex; flex-direction:column; align-items:center}

Â Â /* å›ºå®šç•«å¸ƒå°ºå¯¸ï¼ˆç©©å®šï¼‰â”€â”€è¦æ›´å¤§æ”¹ 360 -> 420/460ï¼ŒCSS èˆ‡ HTML åŒæ­¥ */
Â Â #wheel{
Â Â Â Â width:360px; height:360px; display:block; background:#fff; border-radius:50%;
Â Â Â Â box-shadow:inset 0 0 0 10px rgba(107,35,157,.14), 0 6px 14px rgba(0,0,0,.08);
Â Â }
Â Â #spinBtn:disabled {
Â Â Â Â background-color: #ccc;
Â Â Â Â cursor: not-allowed;

Â Â /* æ·±ç´«è‰²ç®­é ­æŒ‡é‡å›ºå®š 12 ç‚¹ */
Â Â .pointer{
Â Â Â Â position:absolute; top:calc(50% - 200px); left:50%; transform:translateX(-50%);
Â Â Â Â width:0; height:0; border-left:14px solid transparent; border-right:14px solid transparent;
Â Â Â Â border-bottom:26px solid #5c1898; /* æ·±ç´« */
Â Â Â Â filter:drop-shadow(0 2px 2px rgba(0,0,0,.25));
Â Â Â Â z-index:10;
Â Â }
Â Â #status {
Â Â Â Â margin-top: 10px;
Â Â Â Â font-size: 14px;
Â Â .pointer:after{
Â Â Â Â content:""; position:absolute; left:-3px; top:26px; width:6px; height:14px; background:#5c1898; border-radius:3px;
Â Â }
Â Â #footer {
Â Â Â Â margin-top: 20px;
Â Â Â Â font-size: 12px;
Â Â Â Â text-align: center;

Â Â /* ä¸­å¤®æ·±ç´«åœ“å¿ƒï¼ˆè£é£¾ï¼Œä¸è½‰å‹•ï¼‰ */
Â Â .hub{
Â Â Â Â position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
Â Â Â Â width:24%; aspect-ratio:1/1; border-radius:50%; background:#5c1898;
Â Â Â Â box-shadow:0 2px 6px rgba(0,0,0,.18) inset, 0 0 0 10px #fff; pointer-events:none; z-index:2;
Â Â }
Â Â #footer a {
Â Â Â Â color: #007bff;
Â Â Â Â text-decoration: none;

Â Â /* é–‹å§‹ / Start æŒ‰éˆ•ï¼šæ·¡ç²‰åœ“è§’ */
Â Â #spinBtn{
Â Â Â Â margin-top:14px; padding:10px 20px; border:none; border-radius:12px;
Â Â Â Â background:#f7d3e8; color:#4b0c7a; font-weight:800; font-size:16px; cursor:pointer;
Â Â }
Â Â #spinBtn:disabled{opacity:.6; cursor:not-allowed}

Â Â /* å‰©ä½™æ¬¡æ•¸ / Chances */
Â Â #chances{margin-top:6px; font-size:14px}

Â Â /* åº•éƒ¨é€£çµèˆ‡å‚™è¨»ï¼ˆé›™èªï¼‰ */
Â Â .links{margin-top:12px}
Â Â .links a{color:#6b00c8; text-decoration:none; font-weight:700; margin:0 10px}
Â Â .note{margin-top:10px; font-size:12px; color:#444; text-align:center; line-height:1.5}
</style>
</head>
<body>
Â Â <h2>å¹¸è¿è½¬ç›˜ / Lucky Wheel</h2>

Â Â <div class="wrap">
Â Â Â Â <div class="pointer" aria-hidden="true"></div>
Â Â Â Â <!-- åŒæ™‚è¨­å®š HTML å±¬æ€§èˆ‡ CSS å°ºå¯¸ï¼Œä¿è­‰å¯è¦‹ -->
Â Â Â Â <canvas id="wheel" width="360" height="360"></canvas>
Â Â Â Â <div class="hub" aria-hidden="true"></div>
Â Â </div>

Â Â <button id="spinBtn">ğŸ¯ å¼€å§‹ / Start</button>
Â Â <div id="chances">å‰©ä½™æ¬¡æ•° / Chances: --</div>

<h2>å¹¸è¿è½¬ç›˜ / Lucky Wheel</h2>
<div id="wheel-container">
Â Â <div id="pointer"></div>
Â Â <canvas id="wheel" width="400" height="400"></canvas>
</div>
<button id="spinBtn">æ—‹è½¬ / Spin</button>
<div id="status">å‰©ä½™æŠ½å¥–æ¬¡æ•° / Remaining chances: <span id="chances">3</span></div>
<div id="footer">
Â Â âš ï¸æ‰€æœ‰å¥–é¡¹ä¸èƒ½é‡å¤ä½¿ç”¨ / All prizes cannot be used together<br/>
Â Â <a href="https://t.me/pcatdolls" target="_blank">è®¢é˜…/Subscribe & Share Channel</a> / Subscribe and share channel
</div>
Â Â <div class="links">
Â Â Â Â <a id="subLink" href="#">è®¢é˜… / Subscribe</a>
Â Â Â Â <a id="shareLink" href="#">åˆ†äº« / Share</a>
Â Â </div>

Â Â <div class="note">
Â Â Â Â âš ï¸ æ‰€æœ‰å¥–é¡¹ä¸èƒ½é‡å ä½¿ç”¨ / Prizes cannot be combined
Â Â </div>

<script>
const prizes = [
Â Â { text: "45â° or 60â° / 10 off", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: false },
Â Â { text: "45â° or 60â° / 20 off", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: false },
Â Â { text: "One more spin chance", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: true },
Â Â { text: "45â° or 60â° / 10 off", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: false },
Â Â { text: "Sorry ğŸ˜¢", color: ["#ffd700","#ffb6c1","#add8e6","#ffff66"], special: false },
Â Â { text: "45â° or 60â° / 20 off", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: false },
Â Â { text: "Sorry ğŸ˜¢", color: ["#ffd700","#ffb6c1","#add8e6","#ffff66"], special: false },
Â Â { text: "45â° or 60â° / 40 off", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: false },
Â Â { text: "Sorry ğŸ˜¢", color: ["#ffd700","#ffb6c1","#add8e6","#ffff66"], special: false },
/* ===== è§†è§‰é…è‰²ï¼ˆæ¢¦å¹»ç²‰/ç´«/è“/é»„ï¼Œæ¸…æ¥šå¯¹æ¯”ï¼‰ ===== */
const PALETTE = ['#ffd1e8','#cbb2fe','#b6e1ff','#ffe07a'];

/* ===== å¥–é¡¹ï¼ˆ9 é¡¹ï¼›åªä¿ç•™è‹±æ–‡ï¼Œä¸åšä¸­è‹±å¯¹ç…§ï¼‰ ===== */
const PRIZES = [
Â Â { text:'45â° or 60â°/ 10 off', color:PALETTE[0] },
Â Â { text:'45â° or 60â°/ 20 off', color:PALETTE[1] },
Â Â { text:'One more spin chance', color:PALETTE[2], bonus:true },
Â Â { text:'45â° or 60â°/ 10 off', color:PALETTE[3] },
Â Â { text:'Sorry ğŸ˜¢',Â Â Â Â Â Â Â Â Â Â Â Â Â Â color:PALETTE[0] },
Â Â { text:'45â° or 60â°/ 20 off', color:PALETTE[1] },
Â Â { text:'Sorry ğŸ˜¢',Â Â Â Â Â Â Â Â Â Â Â Â Â Â color:PALETTE[2] },
Â Â { text:'45â° or 60â°/ 40 off', color:PALETTE[3] },
Â Â { text:'Sorry ğŸ˜¢',Â Â Â Â Â Â Â Â Â Â Â Â Â Â color:PALETTE[0] },
];

let chances = 3;
let extraSpin = 0; // ç”±"One more spin"çé …ç²å¾—
let lastSpinDate = null;
/* ===== Telegram ç¯å¢ƒ ===== */
const isTG = !!(window.Telegram && Telegram.WebApp);
if (isTG) Telegram.WebApp.ready();
const TG_USER = (isTG && Telegram.WebApp.initDataUnsafe && Telegram.WebApp.initDataUnsafe.user) || null;
const USER_ID = TG_USER ? String(TG_USER.id) : 'guest';
const STORAGE_KEY = 'pcd_wheel_' + USER_ID; // { lastBaseSpinISO, bonus }

// å„²å­˜ä¸­ççµæœ
let lastPrize = null;
/* ===== 3 å¤©é™åˆ¶ & æ¬¡æ•° ===== */
function readState(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {lastBaseSpinISO:null, bonus:0}; }catch(e){ return {lastBaseSpinISO:null, bonus:0}; } }
function writeState(s){ localStorage.setItem(STORAGE_KEY, JSON.stringify(s)); }
function baseAvailable(now=new Date()){ const s=readState(); if(!s.lastBaseSpinISO) return true; return (now - new Date(s.lastBaseSpinISO)) >= 3*24*60*60*1000; }
function totalChances(){ const s=readState(); return (baseAvailable()?1:0) + (s.bonus|0); }
function consumeOne(){ const s=readState(); if(s.bonus>0) s.bonus--; else s.lastBaseSpinISO = new Date().toISOString(); writeState(s); }
function addBonus(n=1){ const s=readState(); s.bonus=(s.bonus|0)+n; writeState(s); }

// åˆå§‹åŒ–è½‰ç›¤
/* ===== DOM ===== */
const canvas = document.getElementById('wheel');
const ctx = canvas.getContext('2d');
const spinBtn = document.getElementById('spinBtn');
const chancesEl = document.getElementById('chances');
const subLink = document.getElementById('subLink');
const shareLink = document.getElementById('shareLink');

function drawWheel() {
Â Â const total = prizes.length;
Â Â const startAngle = 0;
Â Â const arc = Math.PI * 2 / total;
Â Â ctx.clearRect(0, 0, canvas.width, canvas.height);
Â Â const radius = Math.min(canvas.width/2, canvas.height/2);
Â Â for(let i=0; i<total; i++) {
Â Â Â Â ctx.save();
Â Â Â Â ctx.translate(canvas.width/2, canvas.height/2);
/* ===== ç¹ªè£½è½‰ç›¤ï¼ˆåªè½‰ç›¤ã€æŒ‡é‡ä¸å‹•ï¼‰ ===== */
const TOTAL = PRIZES.length;
const ARC = Math.PI * 2 / TOTAL;
const RADIUS = Math.min(canvas.width, canvas.height)/2 - 12; // ç•™å¤–åœˆ

function drawWheel(rotation=0){
Â Â ctx.clearRect(0,0,canvas.width,canvas.height);
Â Â ctx.save();
Â Â ctx.translate(canvas.width/2, canvas.height/2);
Â Â ctx.rotate(rotation); // æ•´ç›¤æ—‹è½‰
Â Â for(let i=0;i<TOTAL;i++){
Â Â Â Â const start = i*ARC;
Â Â Â Â const endÂ Â Â = start + ARC;

Â Â Â Â // æ‰‡å½¢
Â Â Â Â ctx.beginPath();
Â Â Â Â ctx.moveTo(0,0);
Â Â Â Â ctx.fillStyle = prizes[i].color[Math.floor(Math.random()*prizes[i].color.length)];
Â Â Â Â ctx.arc(0, 0, radius, startAngle + i*arc, startAngle + (i+1)*arc);
Â Â Â Â ctx.lineTo(0,0);
Â Â Â Â ctx.fillStyle = PRIZES[i].color;
Â Â Â Â ctx.arc(0,0,RADIUS,start,end,false);
Â Â Â Â ctx.closePath();
Â Â Â Â ctx.fill();

Â Â Â Â // æ–‡å­—
Â Â Â Â ctx.rotate(startAngle + (i+0.5)*arc);
Â Â Â Â ctx.textAlign = "right";
Â Â Â Â ctx.font = "14px Arial";
Â Â Â Â ctx.fillStyle = "#fff";
Â Â Â Â ctx.fillText(prizes[i].text, radius - 10, 8);
Â Â Â Â ctx.save();
Â Â Â Â ctx.rotate(start + ARC/2);
Â Â Â Â ctx.fillStyle = '#333';
Â Â Â Â ctx.font = '14px Quicksand, "Noto Sans SC", -apple-system, BlinkMacSystemFont, "PingFang SC", "Microsoft YaHei", Arial, sans-serif';
Â Â Â Â ctx.textAlign = 'right';
Â Â Â Â ctx.textBaseline = 'middle';
Â Â Â Â ctx.fillText(PRIZES[i].text, RADIUS - 10, 0);
Â Â Â Â ctx.restore();
Â Â }
Â Â ctx.restore();
}
drawWheel();

function getPrizeIndex(angle) {
Â Â const total = prizes.length;
Â Â const arc = Math.PI * 2 / total;
Â Â let index = Math.floor(((angle + Math.PI*2) % (Math.PI*2)) / arc);
Â Â return index;
/* æŒ‡é‡å›ºå®šæ–¼ 12 é»ï¼ˆ-90Â°ï¼‰ï¼›ç”± rotation æ±ºå®šè½é» */
function prizeIndexFromRotation(rotation){
Â Â const norm = (rotation % (Math.PI*2) + Math.PI*2) % (Math.PI*2);
Â Â return Math.floor( ((Math.PI*2) - norm) / ARC ) % TOTAL;
}

function spin() {
Â Â if (chances <= 0) {
Â Â Â Â alert("æ²¡æœ‰å‰©ä½™æ¬¡æ•° / No chances left");
/* ===== UIï¼ˆåŒè¯­ï¼‰ ===== */
function refreshChances(){
Â Â const t = totalChances();
Â Â chancesEl.textContent = 'å‰©ä½™æ¬¡æ•° / Chances: ' + t;
Â Â spinBtn.disabled = t <= 0;
}
subLink.addEventListener('click', e=>{
Â Â e.preventDefault();
Â Â if (isTG) Telegram.WebApp.openTelegramLink('https://t.me/pcatdolls');
Â Â addBonus(1); refreshChances();
});
shareLink.addEventListener('click', e=>{
Â Â e.preventDefault();
Â Â try{
Â Â Â Â if (isTG && Telegram.WebApp.shareToStory) {
Â Â Â Â Â Â Telegram.WebApp.shareToStory({text:'Lucky Wheel', widget_link:'https://t.me/pcatdolls'});
Â Â Â Â } else if (isTG) {
Â Â Â Â Â Â Telegram.WebApp.openTelegramLink('https://t.me/pcatdolls');
Â Â Â Â }
Â Â } finally {
Â Â Â Â addBonus(1); refreshChances();
Â Â }
});

/* ===== æ—‹è½‰å‹•ç•« ===== */
let spinning = false;
spinBtn.addEventListener('click', ()=>{
Â Â if (spinning) return;
Â Â if (totalChances() <= 0){
Â Â Â Â const msg = 'æ¯äºº 3 å¤©å¯è½¬ 1 æ¬¡ / One spin every 3 daysï¼›è®¢é˜…/åˆ†äº«æˆ–æŠ½åˆ° â€œOne more spin chanceâ€ å¯ +1 æ¬¡ / Subscribe, Share, or land on the bonus tile for +1 chance.';
Â Â Â Â if (isTG && Telegram.WebApp.showAlert) Telegram.WebApp.showAlert(msg); else alert(msg);
Â Â Â Â return;
Â Â }
Â Â chances--;
Â Â document.getElementById('chances').innerText = chances + extraSpin;

Â Â const spinDegree = Math.random() * 360 + 360 * 4; // æœ€å°‘è½‰4åœˆ
Â Â const start = performance.now();
Â Â const duration = 4000; // è½‰å‹•æ™‚é–“
Â Â const animate = (now) => {
Â Â Â Â const elapsed = now - start;
Â Â Â Â const progress = Math.min(elapsed / duration, 1);
Â Â Â Â const easeProgress = 1 - Math.pow(1 - progress, 3); // æ¼¸é€²
Â Â Â Â const currentDegree = easeProgress * spinDegree;
Â Â Â Â ctx.save();
Â Â Â Â ctx.translate(canvas.width/2, canvas.height/2);
Â Â Â Â ctx.rotate(currentDegree * Math.PI / 180);
Â Â Â Â ctx.translate(-canvas.width/2, -canvas.height/2);
Â Â Â Â drawWheel();
Â Â Â Â ctx.restore();
Â Â Â Â if (progress < 1) {
Â Â Â Â Â Â requestAnimationFrame(animate);
Â Â Â Â } else {
Â Â Â Â Â Â // åˆ¤æ–·çé …
Â Â Â Â Â Â const finalAngle = (currentDegree % 360);
Â Â Â Â Â Â const prizeIdx = getPrizeIndex(finalAngle * Math.PI/180);
Â Â Â Â Â Â const prize = prizes[prizeIdx];
Â Â Â Â Â Â lastPrize = prize;
Â Â Â Â Â Â // é¡¯ç¤ºçµæœ
Â Â Â Â Â Â alert(`ä¸­å¥– / You won: ${prize.text}`);
Â Â Â Â Â Â // è‹¥çé …æ˜¯"One more spin chance"ï¼Œé¡å¤–å¢åŠ ä¸€æ¬¡
Â Â Â Â Â Â if (prize.text === "One more spin chance") {
Â Â Â Â Â Â Â Â chances++;
Â Â Â Â Â Â Â Â document.getElementById('chances').innerText = chances + extraSpin;
Â Â Â Â Â Â Â Â alert("ç²å¾—é¡å¤–è½‰ç›¤æ©Ÿæœƒ / Extra spin gained!");
Â Â Â Â Â Â }
Â Â Â Â Â Â // å›å‚³é€šçŸ¥ï¼ˆå¯ç”¨Telegram Bot APIé›†æˆï¼‰
Â Â Â Â Â Â sendPrizeMessage(prize.text);
Â Â Â Â }
Â Â };
Â Â requestAnimationFrame(animate);
}
Â Â spinning = true;
Â Â consumeOne(); refreshChances();

function sendPrizeMessage(message) {
Â Â // é€™è£¡å¯ä»¥ç”¨Telegram Bot APIç™¼é€è¨Šæ¯åˆ°@pcd_luckywheel_bot
Â Â // éœ€è¦ä½ çš„bot tokenåŠchat_id
Â Â fetch('https://api.telegram.org/bot 7779859704:AAHwAPPUhTQQRwVJ1FeGJUuY6BJ5vBmFths/sendMessage', {
Â Â Â Â method: 'POST',
Â Â Â Â headers: {'Content-Type': 'application/json'},
Â Â Â Â body: JSON.stringify({
Â Â Â Â Â Â chat_id: '@pcd_luckywheel_bot',
Â Â Â Â Â Â text: `ğŸ‰ æŠ½ççµæœ / Result: ${message}`
Â Â Â Â })
Â Â });
}
Â Â const spinDeg = (360*4) + Math.random()*360; // è‡³å°‘ 4 åœˆ
Â Â const spinRad = spinDeg * Math.PI/180;
Â Â const startTs = performance.now();
Â Â const duration = 4500;

// äº‹ä»¶ç›£è½
document.getElementById('spinBtn').addEventListener('click', spin);

// 3å¤©é™åˆ¶
function checkLastSpin() {
Â Â const now = new Date();
Â Â if (lastSpinDate) {
Â Â Â Â const diff = (now - new Date(lastSpinDate)) / (1000*3600*24);
Â Â Â Â if (diff < 3) {
Â Â Â Â Â Â alert(`æ¯3å¤©åªèƒ½æŠ½ä¸€æ¬¡ / You can only spin once every 3 days`);
Â Â Â Â Â Â document.getElementById('spinBtn').disabled = true;
Â Â Â Â } else {
Â Â Â Â Â Â document.getElementById('spinBtn').disabled = false;
Â Â Â Â }
Â Â function frame(now){
Â Â Â Â const p = Math.min((now - startTs)/duration, 1);
Â Â Â Â const ease = 1 - Math.pow(1-p, 3); // ç¼“å‡º
Â Â Â Â const rot = ease * spinRad;
Â Â Â Â drawWheel(rot);
Â Â Â Â if (p < 1) requestAnimationFrame(frame);
Â Â Â Â else { onSpinDone(rot); spinning = false; }
Â Â }
}
checkLastSpin();
Â Â requestAnimationFrame(frame);
});

/* ===== çµæœè™•ç† & å›å‚³çµ¦ bot ===== */
function onSpinDone(rotation){
Â Â const idx = prizeIndexFromRotation(rotation);
Â Â const prize = PRIZES[idx];

// ç´€éŒ„æœ€å¾Œè½‰å‹•æ™‚é–“
function recordSpin() {
Â Â lastSpinDate = new Date().toISOString();
Â Â // å„²å­˜åˆ°localStorageæˆ–å¾Œç«¯
Â Â if (prize.bonus) {
Â Â Â Â addBonus(1); refreshChances();
Â Â Â Â notify('è·å¾— +1 æ¬¡æœºä¼š / +1 extra chance');
Â Â } else if (/Sorry/i.test(prize.text)) {
Â Â Â Â notify('è°¢è°¢å‚ä¸ / Thanks for playing');
Â Â } else {
Â Â Â Â notify('æ­å–œä¸­å¥–ï¼š' + prize.text + ' / Congratulations!');
Â Â }

Â Â // å›ä¼ ç»™ @pcd_luckywheel_botï¼ˆæŠ½å¥–è€…åå­— + ç»“æœï¼‰ï¼Œç”±ä½ çš„ bot ç«¯æ¥æ”¶ web_app_data
Â Â const u = TG_USER;
Â Â const name = u ? ((u.first_name||'') + (u.last_name?(' '+u.last_name):'')) : 'Guest';
Â Â const handle = u && u.username ? ('@'+u.username) : '';
Â Â const payload = `Winner: ${name}${handle?' '+handle:''} | Result: ${prize.text}`;
Â Â if (isTG && Telegram.WebApp.sendData) { try{ Telegram.WebApp.sendData(payload); }catch(e){} }

Â Â try{ if(isTG && Telegram.WebApp.HapticFeedback){ Telegram.WebApp.HapticFeedback.notificationOccurred('success'); } }catch(e){}
}

// å¢åŠ è¨‚é–±/åˆ†äº«çå‹µ
// æŒ‰éˆ•æˆ–äº‹ä»¶ä¾†è§¸ç™¼é¡å¤–è½‰ç›¤æ©Ÿæœƒ
// é€™è£¡ç¤ºç¯„
// å‡è¨­é»æ“Šå¾Œç²å¾—ä¸€æ¬¡é¡å¤–æ©Ÿæœƒ
function subscribeShare() {
Â Â chances++;
Â Â document.getElementById('chances').innerText = chances + extraSpin;
Â Â alert("ç²å¾—é¡å¤–è½‰ç›¤æ©Ÿæœƒ / Extra spin from subscribe/share!");
function notify(message){
Â Â if (isTG && Telegram.WebApp.showPopup) {
Â Â Â Â Telegram.WebApp.showPopup({title:'å¹¸è¿è½¬ç›˜ / Lucky Wheel', message, buttons:[{type:'ok', id:'ok'}]});
Â Â } else if (isTG && Telegram.WebApp.showAlert) {
Â Â Â Â Telegram.WebApp.showAlert(message);
Â Â } else {
Â Â Â Â alert(message);
Â Â }
}

/* ===== åˆå§‹åŒ– ===== */
window.addEventListener('load', ()=>{
Â Â drawWheel(0);
Â Â refreshChances();
});
</script>
</body>
</html>
