<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>å¹¸é‹è½‰ç›¤</title>
<style>
Â Â body {
Â Â Â Â margin: 0;
Â Â Â Â font-family: Arial, sans-serif;
Â Â Â Â background: #fff0f5;
Â Â Â Â display: flex;
Â Â Â Â flex-direction: column;
Â Â Â Â align-items: center;
Â Â Â Â justify-content: start;
Â Â Â Â height: 100vh;
Â Â Â Â color: #333;
Â Â }
Â Â h2 {
Â Â Â Â margin-top: 10px;
Â Â }
Â Â #wheel-container {
Â Â Â Â position: relative;
Â Â Â Â width: 90vw;
Â Â Â Â max-width: 400px;
Â Â Â Â height: 90vw;
Â Â Â Â max-height: 400px;
Â Â Â Â margin-top: 20px;
Â Â }
Â Â canvas {
Â Â Â Â width: 100%;
Â Â Â Â height: 100%;
Â Â }
Â Â #pointer {
Â Â Â Â position: absolute;
Â Â Â Â top: -10px;
Â Â Â Â left: 50%;
Â Â Â Â transform: translateX(-50%);
Â Â Â Â width: 0; 
Â Â Â Â height: 0; 
Â Â Â Â border-left: 15px solid transparent;
Â Â Â Â border-right: 15px solid transparent;
Â Â Â Â border-bottom: 20px solid #4B0082; /* æ·±ç´«è‰²æŒ‡é‡ */
Â Â Â Â z-index: 10;
Â Â }
Â Â #spinBtn {
Â Â Â Â margin-top: 20px;
Â Â Â Â padding: 12px 24px;
Â Â Â Â background-color: #ff69b4;
Â Â Â Â border: none;
Â Â Â Â border-radius: 8px;
Â Â Â Â color: #fff;
Â Â Â Â font-size: 16px;
Â Â Â Â cursor: pointer;
Â Â }
Â Â #spinBtn:disabled {
Â Â Â Â background-color: #ccc;
Â Â Â Â cursor: not-allowed;
Â Â }
Â Â #status {
Â Â Â Â margin-top: 10px;
Â Â Â Â font-size: 14px;
Â Â }
Â Â #footer {
Â Â Â Â margin-top: 20px;
Â Â Â Â font-size: 12px;
Â Â Â Â text-align: center;
Â Â }
Â Â #footer a {
Â Â Â Â color: #007bff;
Â Â Â Â text-decoration: none;
Â Â }
</style>
</head>
<body>

<h2>å¹¸è¿è½¬ç›˜ / Lucky Wheel</h2>
<div id="wheel-container">
Â Â <div id="pointer"></div>
Â Â <canvas id="wheel" width="400" height="400"></canvas>
</div>
<button id="spinBtn">æ—‹è½¬ / Spin</button>
<div id="status">å‰©ä½™æŠ½å¥–æ¬¡æ•° / Remaining chances: <span id="chances">3</span></div>
<div id="footer">
Â Â âš ï¸æ‰€æœ‰å¥–é¡¹ä¸èƒ½é‡å¤ä½¿ç”¨ / All prizes cannot be used together<br/>
Â Â <a href="https://t.me/pcatdolls" target="_blank">è®¢é˜…/Subscribe & Share Channel</a> / Subscribe and share channel
</div>

<script>
const prizes = [
Â Â { text: "45â° or 60â° / 10 off", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: false },
Â Â { text: "45â° or 60â° / 20 off", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: false },
Â Â { text: "One more spin chance", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: true },
Â Â { text: "45â° or 60â° / 10 off", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: false },
Â Â { text: "Sorry ğŸ˜¢", color: ["#ffd700","#ffb6c1","#add8e6","#ffff66"], special: false },
Â Â { text: "45â° or 60â° / 20 off", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: false },
Â Â { text: "Sorry ğŸ˜¢", color: ["#ffd700","#ffb6c1","#add8e6","#ffff66"], special: false },
Â Â { text: "45â° or 60â° / 40 off", color: ["#ff69b4","#dda0dd","#87cefa","#ffff66"], special: false },
Â Â { text: "Sorry ğŸ˜¢", color: ["#ffd700","#ffb6c1","#add8e6","#ffff66"], special: false },
];

let chances = 3;
let extraSpin = 0; // ç”±"One more spin"çé …ç²å¾—
let lastSpinDate = null;

// å„²å­˜ä¸­ççµæœ
let lastPrize = null;

// åˆå§‹åŒ–è½‰ç›¤
const canvas = document.getElementById('wheel');
const ctx = canvas.getContext('2d');

function drawWheel() {
Â Â const total = prizes.length;
Â Â const startAngle = 0;
Â Â const arc = Math.PI * 2 / total;
Â Â ctx.clearRect(0, 0, canvas.width, canvas.height);
Â Â const radius = Math.min(canvas.width/2, canvas.height/2);
Â Â for(let i=0; i<total; i++) {
Â Â Â Â ctx.save();
Â Â Â Â ctx.translate(canvas.width/2, canvas.height/2);
Â Â Â Â ctx.beginPath();
Â Â Â Â ctx.moveTo(0,0);
Â Â Â Â ctx.fillStyle = prizes[i].color[Math.floor(Math.random()*prizes[i].color.length)];
Â Â Â Â ctx.arc(0, 0, radius, startAngle + i*arc, startAngle + (i+1)*arc);
Â Â Â Â ctx.lineTo(0,0);
Â Â Â Â ctx.fill();

Â Â Â Â // æ–‡å­—
Â Â Â Â ctx.rotate(startAngle + (i+0.5)*arc);
Â Â Â Â ctx.textAlign = "right";
Â Â Â Â ctx.font = "14px Arial";
Â Â Â Â ctx.fillStyle = "#fff";
Â Â Â Â ctx.fillText(prizes[i].text, radius - 10, 8);
Â Â Â Â ctx.restore();
Â Â }
}
drawWheel();

function getPrizeIndex(angle) {
Â Â const total = prizes.length;
Â Â const arc = Math.PI * 2 / total;
Â Â let index = Math.floor(((angle + Math.PI*2) % (Math.PI*2)) / arc);
Â Â return index;
}

function spin() {
Â Â if (chances <= 0) {
Â Â Â Â alert("æ²¡æœ‰å‰©ä½™æ¬¡æ•° / No chances left");
Â Â Â Â return;
Â Â }
Â Â chances--;
Â Â document.getElementById('chances').innerText = chances + extraSpin;

Â Â const spinDegree = Math.random() * 360 + 360 * 4; // æœ€å°‘è½‰4åœˆ
Â Â const start = performance.now();
Â Â const duration = 4000; // è½‰å‹•æ™‚é–“
Â Â const animate = (now) => {
Â Â Â Â const elapsed = now - start;
Â Â Â Â const progress = Math.min(elapsed / duration, 1);
Â Â Â Â const easeProgress = 1 - Math.pow(1 - progress, 3); // æ¼¸é€²
Â Â Â Â const currentDegree = easeProgress * spinDegree;
Â Â Â Â ctx.save();
Â Â Â Â ctx.translate(canvas.width/2, canvas.height/2);
Â Â Â Â ctx.rotate(currentDegree * Math.PI / 180);
Â Â Â Â ctx.translate(-canvas.width/2, -canvas.height/2);
Â Â Â Â drawWheel();
Â Â Â Â ctx.restore();
Â Â Â Â if (progress < 1) {
Â Â Â Â Â Â requestAnimationFrame(animate);
Â Â Â Â } else {
Â Â Â Â Â Â // åˆ¤æ–·çé …
Â Â Â Â Â Â const finalAngle = (currentDegree % 360);
Â Â Â Â Â Â const prizeIdx = getPrizeIndex(finalAngle * Math.PI/180);
Â Â Â Â Â Â const prize = prizes[prizeIdx];
Â Â Â Â Â Â lastPrize = prize;
Â Â Â Â Â Â // é¡¯ç¤ºçµæœ
Â Â Â Â Â Â alert(`ä¸­å¥– / You won: ${prize.text}`);
Â Â Â Â Â Â // è‹¥çé …æ˜¯"One more spin chance"ï¼Œé¡å¤–å¢åŠ ä¸€æ¬¡
Â Â Â Â Â Â if (prize.text === "One more spin chance") {
Â Â Â Â Â Â Â Â chances++;
Â Â Â Â Â Â Â Â document.getElementById('chances').innerText = chances + extraSpin;
Â Â Â Â Â Â Â Â alert("ç²å¾—é¡å¤–è½‰ç›¤æ©Ÿæœƒ / Extra spin gained!");
Â Â Â Â Â Â }
Â Â Â Â Â Â // å›å‚³é€šçŸ¥ï¼ˆå¯ç”¨Telegram Bot APIé›†æˆï¼‰
Â Â Â Â Â Â sendPrizeMessage(prize.text);
Â Â Â Â }
Â Â };
Â Â requestAnimationFrame(animate);
}

function sendPrizeMessage(message) {
Â Â // é€™è£¡å¯ä»¥ç”¨Telegram Bot APIç™¼é€è¨Šæ¯åˆ°@pcd_luckywheel_bot
Â Â // éœ€è¦ä½ çš„bot tokenåŠchat_id
Â Â fetch('https://api.telegram.org/bot 7779859704:AAHwAPPUhTQQRwVJ1FeGJUuY6BJ5vBmFths/sendMessage', {
Â Â Â Â method: 'POST',
Â Â Â Â headers: {'Content-Type': 'application/json'},
Â Â Â Â body: JSON.stringify({
Â Â Â Â Â Â chat_id: '@pcd_luckywheel_bot',
Â Â Â Â Â Â text: `ğŸ‰ æŠ½ççµæœ / Result: ${message}`
Â Â Â Â })
Â Â });
}

// äº‹ä»¶ç›£è½
document.getElementById('spinBtn').addEventListener('click', spin);

// 3å¤©é™åˆ¶
function checkLastSpin() {
Â Â const now = new Date();
Â Â if (lastSpinDate) {
Â Â Â Â const diff = (now - new Date(lastSpinDate)) / (1000*3600*24);
Â Â Â Â if (diff < 3) {
Â Â Â Â Â Â alert(`æ¯3å¤©åªèƒ½æŠ½ä¸€æ¬¡ / You can only spin once every 3 days`);
Â Â Â Â Â Â document.getElementById('spinBtn').disabled = true;
Â Â Â Â } else {
Â Â Â Â Â Â document.getElementById('spinBtn').disabled = false;
Â Â Â Â }
Â Â }
}
checkLastSpin();

// ç´€éŒ„æœ€å¾Œè½‰å‹•æ™‚é–“
function recordSpin() {
Â Â lastSpinDate = new Date().toISOString();
Â Â // å„²å­˜åˆ°localStorageæˆ–å¾Œç«¯
}

// å¢åŠ è¨‚é–±/åˆ†äº«çå‹µ
// æŒ‰éˆ•æˆ–äº‹ä»¶ä¾†è§¸ç™¼é¡å¤–è½‰ç›¤æ©Ÿæœƒ
// é€™è£¡ç¤ºç¯„
// å‡è¨­é»æ“Šå¾Œç²å¾—ä¸€æ¬¡é¡å¤–æ©Ÿæœƒ
function subscribeShare() {
Â Â chances++;
Â Â document.getElementById('chances').innerText = chances + extraSpin;
Â Â alert("ç²å¾—é¡å¤–è½‰ç›¤æ©Ÿæœƒ / Extra spin from subscribe/share!");
}

</script>
</body>
</html>
